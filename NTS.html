<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Report</title>
<style>
  @page { size: A4 portrait; margin: 15mm; }
  body {
    font-family: "Times New Roman", Times, serif;
    font-size: 12px;
    color: #000;
    -webkit-print-color-adjust: exact;
    margin: 0;
    padding: 0;
  }

  .page {
    width: 210mm;
    min-height: 297mm;
    padding: 15mm 18mm;
    box-sizing: border-box;
  }

  .header { display: flex; align-items: center; justify-content: center; margin-bottom: 8px; position: relative; }
  .logo { width: 85px; height: auto; position: absolute; left: 0; }
  .company-info { text-align: center; font-size: 12px; line-height: 1.4; }
  .company-info .line1, .company-info .line2 { font-weight: bold; font-size: 13px; }
  .company-info .line3 { margin-top: 3px; }
  .company-info .line4 { margin-top: 2px; font-size: 11.5px; }
  .company-info .line4 span { display: inline-block; width: 48%; text-align: center; }

  .service-number { text-align: right; margin-top: 8px; font-size: 12px; }
  .service-number span { border: 1px solid #000; padding: 4px 10px; display: inline-block; min-width: 120px; }

  h1 { text-align: center; font-size: 18px; margin: 10px 0 12px 0; letter-spacing: 0.5px; }

  table.form { width: 100%; border-collapse: collapse; border: 1px solid #000; margin-bottom: 8px; }
  table.form td { border: 1px solid #000; padding: 5px 6px; vertical-align: top; }

  .dotted { border-bottom: 1px dotted #000; display: inline-block; width: 100%; height: 14px; }

  .bigbox { border: 1px solid #000; min-height: 100px; padding: 5px; white-space: pre-line; }
  .sign-row { display: flex; justify-content: space-between; margin-top: 18px; }
  .sign { width: 32%; text-align: center; font-size: 12px; }
  .sign-line { border-top: 1px solid #000; margin-top: 25px; padding-top: 4px; }

  .images img {
    width: 30%;
    margin: 4px;
    border: 1px solid #000;
    border-radius: 4px;
  }
</style>
</head>
<body>
<div class="page">

  <div class="header">
    <img src="https://ntsgroup.com.vn/wp-content/uploads/2021/03/nts1.png" class="logo" alt="NTS Logo">
    <div class="company-info">
      <div class="line1">CÔNG TY CỔ PHẦN KHOA HỌC CÔNG NGHỆ MỚI</div>
      <div class="line2">NEW TECHNOLOGIES SCIENTIFIC CORPORATION</div>
      <div class="line3">Tầng 6, 130 Nguyễn Công Trứ, Phường Nguyễn Thái Bình, Quận 1, TP HCM</div>
      <div class="line4">
        <span>https://newntslab.net/</span>
        <span>admin@ntslab.net</span>
      </div>
    </div>
  </div>

  <div class="service-number">
    Service Request Number: <span id="madh"></span>
  </div>

  <h1>CUSTOMER SERVICE REPORT</h1>

  <table class="form">
    <tr>
      <td style="width:45%;">
        <b>Tên công ty / Company:</b><br><div id="tencty" class="dotted"></div>
        <b>Địa chỉ / Address:</b><br><div id="diachicty" class="dotted"></div>
      </td>
      <td style="width:55%;">
        <b>Người liên hệ / Contact Name:</b><br><div id="lienhe" class="dotted"></div>
        <b>Điện thoại / Telephone:</b> <span id="dienthoai" class="dotted" style="width:45%;"></span>
        <b style="float:right;">Ngày / Date:</b> <span id="ngay" class="dotted" style="width:35%; float:right;"></span><br><br>
        <b>Lý do / Service Type:</b><br>
        <div id="loaidv" class="dotted"></div>
      </td>
    </tr>
    <tr>
      <td>
        <b>Mã hàng / Product No.:</b><br><div id="mahang" class="dotted"></div>
        <b>Số serial / Serial No.:</b><br><div id="somay" class="dotted"></div>
      </td>
      <td>
        <b>Ngày bắt đầu / Service Start Date:</b><br><div id="batdau" class="dotted"></div>
        <b>Thời gian kết thúc / Time out:</b> <span id="ketthuc" class="dotted" style="width:38%; float:right;"></span>
      </td>
    </tr>
    <tr>
      <td>
        <b>Mô tả hàng hóa / Product Description:</b><br><div id="mota" class="dotted"></div>
      </td>
      <td>
        <b>Thời gian di chuyển & Khoảng cách / Travel time & Distance:</b><br><div id="khoangcach" class="dotted"></div>
      </td>
    </tr>
  </table>

  <b>Mô tả tình trạng / Problem Description:</b>
  <div class="bigbox" id="tinhtrang"></div>

  <b>Dịch vụ đã hoàn thành & Giải thích các bước thực hiện / Services Done & Explain Service Steps to Customer:</b>
  <div class="bigbox" id="dichvu"></div>

  <b>Remark:</b>
  <div class="bigbox" id="ghichu"></div>

  <div class="sign-row">
    <div class="sign">
      <div class="sign-line" id="kySu">Customer Service Engineer Name</div>
    </div>
    <div class="sign"><div class="sign-line">Customer Service Engineer Signature</div></div>
    <div class="sign"><div class="sign-line" id="ngay2"></div></div>
  </div>

  <div class="images" id="anh-section"></div>

</div>

<script>
  function getParams() {
    const urlParams = new URLSearchParams(window.location.search);
    const fields = [
      "madh","tencty","diachicty","lienhe","dienthoai","loaidv",
      "mahang","somay","batdau","ketthuc","mota","khoangcach",
      "tinhtrang","dichvu","ghichu","kySu"
    ];
    fields.forEach(id => {
      const el = document.getElementById(id);
      if (el && urlParams.get(id)) el.textContent = decodeURIComponent(urlParams.get(id));
    });

    // Gán ngày tự động
    const today = new Date();
    const formatted = today.toLocaleDateString("vi-VN");
    document.getElementById("ngay").textContent = formatted;
    document.getElementById("ngay2").textContent = formatted;

    // Hiển thị ảnh
    const imgSection = document.getElementById("anh-section");
    for (let i = 1; i <= 9; i++) {
      const param = urlParams.get("anh" + i);
      if (param) {
        const img = document.createElement("img");
        img.src = decodeURIComponent(param);
        imgSection.appendChild(img);
      }
    }
  }
  window.onload = getParams;
</script>
</body>
</html>
