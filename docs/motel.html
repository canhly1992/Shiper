<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Biên lai thanh toán phòng</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .invoice-box {
      max-width: 900px;
      margin: auto;
      border: 1px solid #000;
      padding: 20px;
      font-size: 14px;
      line-height: 20px;
    }
    h2, h3 { text-align: center; margin: 5px 0; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    table, th, td {
      border: 1px solid #000;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
    .qr-box {
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="invoice-box">
    <h2>PHIẾU THU TIỀN PHÒNG</h2>
    <h3>HÓA ĐƠN THANH TOÁN</h3>

    <p><strong>Họ tên khách:</strong> <span id="hoten"></span></p>
    <p><strong>Mã phòng:</strong> <span id="maso"></span></p>
    <p><strong>Số điện thoại:</strong> <span id="sdt"></span></p>

    <h3>Chi tiết thanh toán</h3>
    <table>
      <tr><th>Dịch vụ</th><th>Số cũ</th><th>Số mới</th><th>Đơn giá</th><th>Thành tiền</th></tr>
      <tr><td>Điện</td><td id="sodiencu"></td><td id="sodienmoi"></td><td id="giadien"></td><td id="tongtiendien"></td></tr>
      <tr><td>Nước</td><td id="sonuoccu"></td><td id="sonuocmoi"></td><td id="gianuoc"></td><td id="tongtiennuoc"></td></tr>
      <tr><td>Internet</td><td colspan="3"></td><td id="tieninternet"></td></tr>
      <tr><td>Phí đổ rác</td><td colspan="3"></td><td id="rac"></td></tr>
      <tr><td>Gửi xe (<span id="soluongxe"></span> xe)</td><td colspan="2"></td><td id="phixe"></td><td id="tongphixe"></td></tr>
      <tr><td>Chi phí khác</td><td colspan="3"></td><td id="chiphipkhac"></td></tr>
      <tr><td>Tiền phòng</td><td colspan="3"></td><td id="tongtienphong"></td></tr>
      <tr><th colspan="4">Tổng cộng</th><th id="tongtien"></th></tr>
      <tr><th colspan="4">Giảm giá</th><th id="giagiam"></th></tr>
      <tr><th colspan="4">Còn lại phải thanh toán</th><th id="conlai"></th></tr>
    </table>

    <div class="qr-box">
      <h3>QR Code Thanh Toán</h3>
      <img id="vietqr" src="" alt="QR Code thanh toán" style="width:200px;height:200px;">
    </div>

    <p><strong>Tên tài khoản:</strong> <span id="tentaikhoan"></span></p>
    <p><strong>Số tài khoản:</strong> <span id="sotaikhoan"></span></p>
    <p><strong>Ngân hàng:</strong> <span id="nganhang"></span></p>
  </div>

  <script>
    function getParam(param) {
      return new URLSearchParams(window.location.search).get(param) || "";
    }

    // Gán dữ liệu vào HTML
    const fields = ["hoten","maso","sdt","sodiencu","sodienmoi","giadien","tongtiendien","sonuoccu","sonuocmoi","gianuoc","tongtiennuoc","tieninternet","rac","soluongxe","phixe","tongphixe","chiphipkhac","tongtienphong","tongtien","giagiam","conlai","tentaikhoan","sotaikhoan","nganhang"];
    fields.forEach(id => document.getElementById(id).innerText = getParam(id));

    // QR Code Thanh toán
    const bank = getParam("nganhang");      // mã ngân hàng (VD: VCB)
    const account = getParam("sotaikhoan"); // số tài khoản
    const name = getParam("tentaikhoan");   // tên tài khoản
    const amount = getParam("conlai");      // số tiền cần trả
    const maso = getParam("maso");          // mã phòng
    const hoten = getParam("hoten");        // họ tên khách
    const noidung = `Thanh toan phong ${maso} - ${hoten}`;

    if (bank && account) {
      const qrUrl = `https://img.vietqr.io/image/${bank}-${account}-compact2.png?amount=${amount}&addInfo=${encodeURIComponent(noidung)}&accountName=${encodeURIComponent(name)}`;
      document.getElementById("vietqr").src = qrUrl;
    }
  </script>
</body>
</html>
