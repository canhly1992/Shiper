<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Receipt Room</title>
  <style>
    body { font-family: "Times New Roman", serif; font-size: 12px; margin: 20px; color: #000; }
    .header { display: flex; justify-content: space-between; margin-bottom: 10px; }
    .header-left { width: 60%; }
    .header-right { text-align: right; }
    .title { text-align: center; font-size: 16px; font-weight: bold; margin: 10px 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 8px; }
    table, th, td { border: 1px solid #000; }
    th, td { padding: 4px; text-align: center; }
    td.left { text-align: left; }
    .total { font-weight: bold; background: #eee; }
    .qr-section { display: flex; margin-top: 12px; }
    .qr-section .info { flex: 1; font-size: 12px; }
    .qr-section .qr { width: 200px; text-align: center; }
    .highlight-yellow { background: yellow; font-weight: bold; }
    .highlight-red { color: red; font-weight: bold; }
    .sign { margin-top: 20px; display: flex; justify-content: space-between; font-size: 12px; text-align: center; }
  </style>
</head>
<body>

  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <p><b>122 No, Tu Hoa, Quang An, Tay Ho.</b></p>
      <p>Contact: +84328.972.855 (Mr Long Management)</p>
      <p>(Plz Text: WhatsApp or Zalo)</p>
    </div>
    <div class="header-right">
      <p><b>Date:</b> <span id="ngay"></span></p>
    </div>
  </div>

  <div class="title">RECEIPT ROOM <span id="maso"></span></div>

  <!-- Customer Info -->
  <table>
    <tr>
      <td class="left"><b>Full Name</b></td>
      <td colspan="5" id="hoten"></td>
    </tr>
    <tr>
      <td class="left"><b>Address</b></td>
      <td colspan="3" id="diachi"></td>
      <td><b>Phone</b></td>
      <td id="sdt"></td>
    </tr>
  </table>

  <!-- Bill Table -->
  <table id="table-bill">
    <thead>
      <tr>
        <th>Dịch vụ</th>
        <th>Số cũ</th>
        <th>Số mới</th>
        <th>Số tiêu thụ</th>
        <th>Đơn giá</th>
        <th>Tổng</th>
        <th>Remark</th>
      </tr>
    </thead>
    <tbody>
      <!-- Hàng dữ liệu sẽ thêm từ param -->
    </tbody>
    <tfoot>
      <tr>
        <td colspan="5" class="left total">Tổng cộng</td>
        <td class="total" id="tongtien"></td><td></td>
      </tr>
      <tr>
        <td colspan="5" class="left">Giảm giá</td>
        <td id="giamgia">-</td><td></td>
      </tr>
      <tr>
        <td colspan="5" class="left">Còn lại</td>
        <td id="conlai"></td><td></td>
      </tr>
    </tfoot>
  </table>

  <!-- QR + Banking -->
  <div class="qr-section">
    <div class="info">
      <p><b>The total amount payable:</b> <span id="tongtien_text"></span> VND</p>
      <p><b>Transfer Information:</b></p>
      <p>NAME ACCOUNT: <span id="tentaikhoan"></span></p>
      <p>NUMBER ACCOUNT: <span id="sotaikhoan"></span></p>
      <p>BANK NAME: <span id="nganhang"></span></p>
      <p><b>Transfer Content:</b> <span class="highlight-yellow" id="noidungck"></span></p>
      <p class="highlight-red">
        IMPORTANT: Using the correct content of the message, if it is wrong, it will be considered as not collecting money yet.<br>
        QUAN TRỌNG: Sử dụng đúng nội dung tin nhắn nếu sai coi như chưa thu tiền.
      </p>
    </div>
    <div class="qr">
      <img id="qrpay" src="" alt="QR Payment">
    </div>
  </div>

  <!-- Sign -->
  <div class="sign">
    <div>
      <b>Khách hàng</b><br>(Ký và ghi rõ họ tên)
    </div>
    <div>
      <b>Vu Cao Long</b><br>(Người thu tiền)
    </div>
  </div>

  <script>
    function getParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return decodeURIComponent(urlParams.get(name) || "");
    }

    // Set ngày
    const now = new Date();
    document.getElementById("ngay").innerText =
      `${String(now.getDate()).padStart(2,"0")}/${String(now.getMonth()+1).padStart(2,"0")}/${now.getFullYear()}`;

    // Inject data từ param
    const fields = ["hoten","diachi","sdt","maso","tentaikhoan","sotaikhoan","nganhang","tongtien","conlai"];
    fields.forEach(f=>{
      const el=document.getElementById(f);
      if(el) el.innerText=getParam(f);
    });
    document.getElementById("tongtien_text").innerText=getParam("tongtien");
    document.getElementById("noidungck").innerText = `${getParam("diachi")}.${getParam("maso")} TT BILL ${now.getMonth()+1}`;

    // QR Code động
    const qrUrl = "https://canhly1992.github.io/Shiper/motel.html"
      + "?hoten=" + encodeURIComponent(getParam("hoten"))
      + "&diachi=" + encodeURIComponent(getParam("diachi"))
      + "&maso=" + encodeURIComponent(getParam("maso"))
      + "&sotaikhoan=" + encodeURIComponent(getParam("sotaikhoan"))
      + "&tentaikhoan=" + encodeURIComponent(getParam("tentaikhoan"))
      + "&nganhang=" + encodeURIComponent(getParam("nganhang"))
      + "&sdt=" + encodeURIComponent(getParam("sdt"))
      + "&tongtien=" + encodeURIComponent(getParam("tongtien"))
      + "&data=" + encodeURIComponent(getParam("data"));

    document.getElementById("qrpay").src =
      "https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=" + encodeURIComponent(qrUrl);
  </script>

</body>
</html>
