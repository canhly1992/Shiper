<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Báo cáo dịch vụ</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<style>
  body {
    font-family: "Times New Roman", serif;
    margin: 0;
    padding: 0;
    background: #fff;
  }

  .container {
    width: 90%;
    margin: 0 auto;
    padding: 20px;
    position: relative;
  }

  /* Watermark logo */
  .watermark {
    position: fixed;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%);
    opacity: 0.1;
    z-index: -1;
    width: 300px;
  }

  header {
    border-bottom: 4px solid #005a9e;
    color: #005a9e;
    padding-bottom: 10px;
    margin-bottom: 20px;
    text-align: center;
  }

  h1 {
    font-size: 22px;
    margin-bottom: 5px;
  }

  .btn-print {
    position: fixed;
    top: 15px;
    right: 15px;
    background-color: #005a9e;
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    z-index: 9999;
  }

  .images-section {
    text-align: center;
    page-break-before: always;
  }

  .images-row {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }

  .image-box {
    width: 30%;
    margin: 1%;
    border: 2px solid #005a9e;
    border-radius: 8px;
    overflow: hidden;
    text-align: center;
    padding: 10px;
  }

  .image-box img {
    width: 100%;
    height: 250px;
    object-fit: cover;
  }

  .image-box p {
    font-size: 13px;
    margin-top: 5px;
  }

  footer {
    text-align: center;
    margin-top: 40px;
    color: #555;
  }
</style>
</head>
<body>
  <button class="btn-print" onclick="exportPDF()">In báo cáo / Xuất PDF</button>

  <div class="container" id="reportContent">
    <img src="https://i.imgur.com/ujw9zC3.png" class="watermark" alt="Watermark Logo">

    <header>
      <h1>BÁO CÁO DỊCH VỤ</h1>
      <p><strong>Công ty:</strong> <span id="companyName">Newtech Co.</span></p>
      <p><strong>Mã số:</strong> <span id="reportCode">24102025-2014</span></p>
    </header>

    <section>
      <p><b>Kính gửi Quý Công ty,</b></p>
      <p>Chúng tôi xin gửi đến Quý Công ty báo cáo chi tiết về dịch vụ đã thực hiện trong thời gian vừa qua. Báo cáo này bao gồm thông tin kỹ thuật, hình ảnh minh họa và các ghi chú quan trọng.</p>
      <p>Xin chân thành cảm ơn Quý Công ty đã tin tưởng và hợp tác.</p>
    </section>

    <div class="images-section">
      <h2>HÌNH ẢNH / IMAGES</h2>
      <div class="images-row">
        <div class="image-box">
          <img src="https://i.imgur.com/N0iN9mt.jpeg" alt="Image 1">
          <p>Image 1</p>
        </div>
        <div class="image-box">
          <img src="https://i.imgur.com/zC0H7xk.jpeg" alt="Image 2">
          <p>Image 2</p>
        </div>
        <div class="image-box">
          <img src="https://i.imgur.com/3q3jZrP.jpeg" alt="Image 3">
          <p>Image 3</p>
        </div>
      </div>
    </div>

    <footer>
      <p>— Báo cáo được tạo tự động từ hệ thống —</p>
    </footer>
  </div>

<script>
function exportPDF() {
  const element = document.getElementById("reportContent");
  const company = document.getElementById("companyName").innerText.trim();
  const code = document.getElementById("reportCode").innerText.trim();

  const opt = {
    margin: 5,
    filename: `${company} - ${code}.pdf`,
    image: { type: 'jpeg', quality: 1 },
    html2canvas: { scale: 3, useCORS: true },
    jsPDF: { unit: 'mm', format: 'b4', orientation: 'portrait' },
    pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
  };

  html2pdf().set(opt).from(element).save();
}
</script>
</body>
</html>
