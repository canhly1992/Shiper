<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>B√°o c√°o d·ªãch v·ª• kh√°ch h√†ng</title>
<style>
  @page { size: B4 portrait; margin: 10mm; }

  body {
    font-family: "Times New Roman", Times, serif;
    font-size: 12px;
    color: #000;
    -webkit-print-color-adjust: exact;
    margin: 0;
    padding: 0;
    background: #fff;
  }

  .page {
    width: 257mm;
    min-height: 364mm;
    padding: 15mm 18mm;
    position: relative;
    box-sizing: border-box;
    page-break-after: always;
  }

  .watermark {
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    opacity: 0.08;
    z-index: 0;
    width: 60%;
  }

  .header {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 8px;
    position: relative;
    border-bottom: 2px solid #1a73e8;
    padding-bottom: 6px;
  }

  .logo {
    width: 95px;
    height: auto;
    position: absolute;
    left: 0;
  }

  .company-info {
    text-align: center;
    font-size: 12px;
    line-height: 1.4;
  }

  .company-info .line1, .company-info .line2 {
    font-weight: bold;
    font-size: 13px;
    color: #1a73e8;
  }

  h1 {
    text-align: center;
    font-size: 18px;
    margin: 10px 0 12px 0;
    color: #1a73e8;
  }

  table.form {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid #000;
    margin-bottom: 8px;
    position: relative;
    z-index: 1;
  }

  table.form td {
    border: 1px solid #000;
    padding: 5px 6px;
    vertical-align: top;
  }

  .bigbox {
    border: 1px solid #000;
    min-height: 80px;
    padding: 5px;
    white-space: pre-wrap;
    z-index: 1;
    position: relative;
  }

  .sign-row {
    display: flex;
    justify-content: space-between;
    margin-top: 18px;
    position: relative;
    z-index: 1;
  }

  .sign {
    width: 32%;
    text-align: center;
    font-size: 12px;
  }

  .sign-line {
    border-top: 1px solid #000;
    margin-top: 25px;
    padding-top: 4px;
  }

  #images-page {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    justify-items: center;
    margin-top: 25px;
    position: relative;
    z-index: 1;
  }

  #images-page img {
    width: 100%;
    max-width: 240px;
    aspect-ratio: 1 / 1;
    object-fit: cover;
    border: 2px solid #1a73e8;
    border-radius: 6px;
    padding: 3px;
    background: #f8f9ff;
  }

  #printBtn {
    position: fixed;
    top: 10px;
    right: 15px;
    padding: 8px 16px;
    background: #1a73e8;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    z-index: 9999;
  }

  #printBtn:hover {
    background: #0b5ed7;
  }

  @media print {
    #printBtn { display: none; }
  }
</style>
</head>
<body>

<button id="printBtn">üñ®Ô∏è In b√°o c√°o / Xu·∫•t PDF</button>

<!-- PAGE 1 -->
<div class="page" id="page1">
  <img src="https://ntsgroup.com.vn/wp-content/uploads/2021/03/nts1.png" class="watermark" alt="Watermark">
  <div class="header">
    <img src="https://ntsgroup.com.vn/wp-content/uploads/2021/03/nts1.png" class="logo" alt="Logo">
    <div class="company-info">
      <div class="line1">C√îNG TY C·ªî PH·∫¶N KHOA H·ªåC C√îNG NGH·ªÜ M·ªöI</div>
      <div class="line2">NEW TECHNOLOGIES SCIENTIFIC CORPORATION</div>
      <div>T·∫ßng 6, 130 Nguy·ªÖn C√¥ng Tr·ª©, Q.1, TP.HCM</div>
      <div>https://newntslab.net | admin@ntslab.net</div>
    </div>
  </div>

  <h1>CUSTOMER SERVICE REPORT / B√ÅO C√ÅO D·ªäCH V·ª§ KH√ÅCH H√ÄNG</h1>

  <table class="form">
    <tr>
      <td><b>C√¥ng ty:</b> <span id="tencty"></span></td>
      <td><b>M√£ ƒë∆°n h√†ng:</b> <span id="madh"></span></td>
    </tr>
    <tr>
      <td><b>ƒê·ªãa ch·ªâ:</b> <span id="diachicty"></span></td>
      <td><b>Ng∆∞·ªùi li√™n h·ªá:</b> <span id="lienhe"></span></td>
    </tr>
    <tr>
      <td><b>S·ªë ƒëi·ªán tho·∫°i:</b> <span id="dienthoai"></span></td>
      <td><b>Lo·∫°i d·ªãch v·ª•:</b> <span id="loaidv"></span></td>
    </tr>
    <tr>
      <td><b>M√£ h√†ng:</b> <span id="mahang"></span></td>
      <td><b>S·ªë m√°y:</b> <span id="somay"></span></td>
    </tr>
    <tr>
      <td><b>Ng√†y b·∫Øt ƒë·∫ßu:</b> <span id="batdau"></span></td>
      <td><b>Ng√†y k·∫øt th√∫c:</b> <span id="ketthuc"></span></td>
    </tr>
    <tr>
      <td><b>H√£ng SX:</b> <span id="hangsx"></span></td>
      <td><b>Kho·∫£ng c√°ch:</b> <span id="khoangcach"></span></td>
    </tr>
  </table>

  <b>T√¨nh tr·∫°ng:</b>
  <div class="bigbox" id="tinhtrang"></div>
  <b>D·ªãch v·ª• ho√†n th√†nh:</b>
  <div class="bigbox" id="dichvu"></div>
  <b>Ghi ch√∫:</b>
  <div class="bigbox" id="ghichu"></div>

  <div class="sign-row">
    <div class="sign"><div class="sign-line">K·ªπ s∆∞ d·ªãch v·ª•</div></div>
    <div class="sign"><div class="sign-line">Kh√°ch h√†ng k√Ω</div></div>
    <div class="sign"><div class="sign-line">Ng√†y</div></div>
  </div>
</div>

<!-- PAGE 2 -->
<div class="page" id="page2">
  <img src="https://ntsgroup.com.vn/wp-content/uploads/2021/03/nts1.png" class="watermark" alt="Watermark">
  <h1>H√åNH ·∫¢NH / IMAGES</h1>
  <div id="images-page"></div>
</div>

<script>
const params = new URLSearchParams(window.location.search);
function setVal(id) {
  const el = document.getElementById(id);
  if (el) el.textContent = decodeURIComponent(params.get(id) || "");
}
["tencty","madh","diachicty","lienhe","dienthoai","loaidv","mahang","somay",
 "batdau","ketthuc","hangsx","khoangcach","tinhtrang","dichvu","ghichu"]
.forEach(setVal);

const imgCtn = document.getElementById("images-page");
let imagesLoaded = 0;
let totalImages = 0;

for (let i = 1; i <= 9; i++) {
  const file = params.get("anh" + i);
  if (file) {
    totalImages++;
    const img = new Image();
    img.src = `https://www.appsheet.com/template/gettablefileurl?appName=Qu%E1%BA%A3nl%C3%BDd%E1%BB%8Bchv%E1%BB%A5-300959436&tableName=Th%C3%B4ng%20tin%20chung&fileName=${decodeURIComponent(file)}`;
    img.onload = () => {
      imagesLoaded++;
      if (imagesLoaded === totalImages) document.getElementById("printBtn").disabled = false;
    };
    img.onerror = () => imagesLoaded++;
    imgCtn.appendChild(img);
  }
}

document.getElementById("printBtn").addEventListener("click", async () => {
  await new Promise(r => setTimeout(r, 800)); // ƒë·∫£m b·∫£o ·∫£nh render
  const fileName = `${document.getElementById("tencty").textContent.trim()} - ${document.getElementById("madh").textContent.trim()}.pdf`;
  window.print();
});
</script>
</body>
</html>
