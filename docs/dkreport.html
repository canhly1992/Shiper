<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>THÔNG TIN ĐƠN KÍNH</title>
  <style>
    body {
      font-family: 'Times New Roman', serif;
      font-size: 12px;
      margin: 10px;
      width: 148mm;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    td, th {
      border: 1px solid #000;
      padding: 4px;
      text-align: center;
      height: 22px; /* ✅ giữ chiều cao ổn định cho mọi ô */
    }
    .header {
      text-align: center;
      line-height: 1.5;
    }
    .info-section {
      margin-top: 10px;
    }
    .line, .line-double {
      display: flex;
      justify-content: space-between;
      margin-top: 3px;
    }
    .line > div {
      width: 32%;
    }
    .line-double > div {
      width: 49%;
    }
    .bold-center {
      font-weight: bold;
      text-align: center;
    }
    th {
      font-weight: bold;
    }
    td:first-child {
      font-weight: normal;
    }
  </style>
  <script>
    function getParam(name) {
      const url = new URL(window.location.href);
      return decodeURIComponent(url.searchParams.get(name) || "");
    }

    window.onload = function () {
      const fields = [
        "Ngay", "MaSo", "HoTen", "SinhNgay", "GioiTinh", "SDT", "DiaChi", "BacSi", "ChanDoan",
        "MP", "MT", "TLP", "TLT",
        "DCP", "TRUP", "TRUCP", "DCT", "TRUT", "TRUCT",
        "TLCKMP", "TLCKMT",
        "CKCP", "CKTP", "CKTRUCP", "CKMPTLCK",
        "CKCT", "CKTT", "CKTRUCT", "CKMTTLCK",
        "KhoangCach", "ADDMP", "ADDMT",
        "GP", "GT", "A", "A2", "PD", "KinhDeNghi"
      ];
      fields.forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          const val = getParam(id);
          el.textContent = (val === "0" || val) ? val : "\u00A0"; // giữ khoảng trắng nếu rỗng
        }
      });

      setTimeout(() => {
        window.print();
        setTimeout(() => window.close(), 100);
      }, 1000);
    };
  </script>
</head>
<body>

<div class="header">
  <strong>3H OPTICAL</strong><br>
  <strong>Địa chỉ:</strong> 314 Nguyễn Thượng Hiền, Phường 5, Quận Phú Nhuận, TP.HCM<br>
  <strong>Điện thoại:</strong> 0909592909 - 09095832909<br><br>
  <strong>THÔNG TIN KHÁCH HÀNG</strong>
</div>

<div class="info-section">
  <div><strong>Họ và tên:</strong> <span id="HoTen">&nbsp;</span></div>

  <div class="line">
    <div><strong>Giới tính:</strong> <span id="GioiTinh">&nbsp;</span></div>
    <div><strong>Năm sinh:</strong> <span id="SinhNgay">&nbsp;</span></div>
    <div><strong>SĐT:</strong> <span id="SDT">&nbsp;</span></div>
  </div>

  <div style="margin-top: 3px;"><strong>Địa chỉ:</strong> <span id="DiaChi">&nbsp;</span></div>

  <div class="line-double">
    <div><strong>Bác sĩ/KTV:</strong> <span id="BacSi">&nbsp;</span></div>
    <div><strong>Ngày kiểm tra:</strong> <span id="Ngay">&nbsp;</span></div>
  </div>

  <div style="margin-top: 3px;"><strong>Chẩn đoán:</strong> <span id="ChanDoan">&nbsp;</span></div>
</div>

<table>
  <tr>
    <th rowspan="2"><strong>THỊ LỰC KÍNH CŨ (VA)</strong></th>
    <th colspan="3"><strong>Mắt Phải (OD)</strong></th>
    <th colspan="3"><strong>Mắt Trái (OS)</strong></th>
  </tr>
  <tr>
    <td colspan="3"><span id="MP">&nbsp;</span></td>
    <td colspan="3"><span id="MT">&nbsp;</span></td>
  </tr>
  <tr>
    <td><strong>THỊ LỰC KHÔNG KÍNH</strong></td>
    <td colspan="3" id="TLP">&nbsp;</td>
    <td colspan="3" id="TLT">&nbsp;</td>
  </tr>
  <tr>
    <th rowspan="2"><strong>KHÚC XẠ HIỆN TẠI</strong></th>
    <th><strong>ĐỘ CẦU</strong></th><th><strong>ĐỘ LOẠN</strong></th><th><strong>TRỤC</strong></th>
    <th><strong>ĐỘ CẦU</strong></th><th><strong>ĐỘ LOẠN</strong></th><th><strong>TRỤC</strong></th>
  </tr>
  <tr>
    <td id="DCP">&nbsp;</td><td id="TRUP">&nbsp;</td><td id="TRUCP">&nbsp;</td>
    <td id="DCT">&nbsp;</td><td id="TRUT">&nbsp;</td><td id="TRUCT">&nbsp;</td>
  </tr>
  <tr>
    <td><strong>TLCK HIỆN TẠI</strong></td>
    <td colspan="3" id="TLCKMP">&nbsp;</td>
    <td colspan="3" id="TLCKMT">&nbsp;</td>
  </tr>
  <tr>
    <td><strong>KHÚC XẠ ĐIỀU CHỈNH</strong></td>
    <td id="CKCP">&nbsp;</td><td id="CKTP">&nbsp;</td><td id="CKTRUCP">&nbsp;</td>
    <td id="CKCT">&nbsp;</td><td id="CKTT">&nbsp;</td><td id="CKTRUCT">&nbsp;</td>
  </tr>
  <tr>
    <td><strong>TLCK ĐIỀU CHỈNH</strong></td>
    <td colspan="3"><span id="CKMPTLCK">&nbsp;</span></td>
    <td colspan="3"><span id="CKMTTLCK">&nbsp;</span></td>
  </tr>
  <tr>
    <td><strong>ADD</strong></td>
    <td colspan="3"><span id="ADDMP">&nbsp;</span></td>
    <td colspan="3"><span id="ADDMT">&nbsp;</span></td>
  </tr>
  <tr>
    <td><strong>THỊ LỰC NHÌN GẦN</strong></td>
    <td colspan="3"><span id="GP">&nbsp;</span></td>
    <td colspan="3"><span id="GT">&nbsp;</span></td>
  </tr>
  <tr>
    <td><strong>MONO PD</strong></td>
    <td colspan="3"><span id="A">&nbsp;</span></td>
    <td colspan="3"><span id="A2">&nbsp;</span></td>
  </tr>
  <tr>
    <td><strong>PD</strong></td>
    <td colspan="6" id="PD">&nbsp;</td>
  </tr>
  <tr>
    <td><strong>KÍNH ĐỀ NGHỊ</strong></td>
    <td colspan="6" id="KinhDeNghi">&nbsp;</td>
  </tr>
  <tr>
    <td colspan="7"><strong>Nhìn gần tốt nhất ở khoảng cách:</strong> <span id="KhoangCach">&nbsp;</span> <strong>cm</strong></td>
  </tr>
  <tr>
    <td colspan="7" class="bold-center">Tái khám <strong>6 tháng / lần</strong></td>
  </tr>
</table>

</body>
</html>
