<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>PHIẾU BÁN HÀNG</title>
  <style>
    body {
      font-family: 'Times New Roman', serif;
      font-size: 14px;
      margin: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid black;
      padding: 6px;
      text-align: left;
    }
    .center {
      text-align: center;
    }
    .no-border {
      border: none;
    }
  </style>
</head>
<body>

  <h2 class="center">3H OPTICAL</h2>
  <div class="center">314 Nguyễn Thượng Hiền, P.5, Q. Phú Nhuận, TP.HCM</div>
  <div class="center">Điện thoại: 756000</div>

  <h3 class="center">PHIẾU BÁN HÀNG</h3>

  <div><b>Họ tên:</b> <span id="hoten"></span></div>
  <div><b>Mã số:</b> <span id="maso"></span></div>
  <div><b>Năm sinh:</b> <span id="namsinh"></span></div>
  <div><b>SĐT:</b> <span id="sdt"></span></div>
  <div><b>Địa chỉ:</b> <span id="diachi"></span></div>
  <div><b>Giới tính:</b> <span id="gioitinh"></span></div>
  <div><b>Bác sĩ / KTV:</b> <span id="bacsi"></span></div>

  <table id="table">
    <thead>
      <tr>
        <th>TÊN DỊCH VỤ</th>
        <th>SỐ LƯỢNG</th>
        <th>ĐƠN GIÁ</th>
        <th>CHIẾT KHẤU</th>
        <th>TRẠNG THÁI</th>
        <th>TỔNG TIỀN</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>

  <table style="margin-top: 20px;">
    <tr>
      <td class="no-border"><b>TỔNG TIỀN</b></td>
      <td class="no-border"><span id="tongtien"></span> đ</td>
    </tr>
    <tr>
      <td class="no-border"><b>TẠM ỨNG</b></td>
      <td class="no-border"><span id="tamung"></span> đ</td>
    </tr>
    <tr>
      <td class="no-border"><b>CẦN THANH TOÁN</b></td>
      <td class="no-border"><span id="canthanhtoan"></span> đ</td>
    </tr>
  </table>

  <p style="margin-top: 40px;">Người nộp tiền <br>(Ký, ghi rõ họ tên)</p>

  <script>
    const params = new URLSearchParams(window.location.search);

    // Gán thông tin cá nhân
    document.getElementById("hoten").textContent = params.get("hoten") || "";
    document.getElementById("maso").textContent = params.get("maso") || "";
    document.getElementById("namsinh").textContent = params.get("namsinh") || "";
    document.getElementById("sdt").textContent = params.get("sdt") || "";
    document.getElementById("diachi").textContent = params.get("diachi") || "";
    document.getElementById("gioitinh").textContent = params.get("gioitinh") || "";
    document.getElementById("bacsi").textContent = params.get("bacsi") || "";

    // Gán thông tin thanh toán
    document.getElementById("tongtien").textContent = params.get("tongtien") || "0";
    document.getElementById("tamung").textContent = params.get("tamung") || "0";
    document.getElementById("canthanhtoan").textContent = params.get("canthanhtoan") || "0";

    // Dữ liệu sản phẩm
    const data = decodeURIComponent(params.get("data") || "");
    const rows = data.split("_b_");

    const tbody = document.querySelector("#table tbody");
    rows.forEach(row => {
      const cells = row.split("_a_");
      if (cells.length >= 7) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${cells[0]}</td>
          <td>${cells[1]}</td>
          <td>${cells[2]} đ</td>
          <td>${cells[4]} đ</td>
          <td>${cells[5]}</td>
          <td>${cells[6]} đ</td>
        `;
        tbody.appendChild(tr);
      }
    });
  </script>

</body>
</html>
